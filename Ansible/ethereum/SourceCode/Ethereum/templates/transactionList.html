{% extends 'template.html' %}

{% block pageTitle %}.:: Wallet : Transactions List ::.{% endblock %}

{% block pageHeader %}.:: Wallet : Transactions List ::.{% endblock %}

{% block cssLink %}

{% endblock %}



{% block jsLink %}


<script type = "text/javascript" src ="{{ url_for('static', filename = 'js/web3/web3.min.js') }}" ></script>

<script src="{{ url_for('static', filename = 'js/web3/keythereum.min.js') }}"  type="text/javascript"></script>

<script type = "text/javascript" src ="{{ url_for('static', filename = 'js/jquery-3.3.1.min.js') }}" ></script>

<script type = "text/javascript" src ="{{ url_for('static', filename = 'js/particles.js') }}" ></script>

<script src="{{ url_for('static', filename = 'js/sweetalert.min.js') }}"></script>

<script src="{{ url_for('static', filename = 'js/jquery.qrcode.js') }}"></script>
<script src="{{ url_for('static', filename = 'js/qrcode.js') }}"></script>

{% endblock %}

{% block content %}
    <table id="tbTransactionList" >
        <thead>
            <tr>
                <th class='hash'> TxHash </th>
                <th class='direction'> Direction </th>
                <th class='from'> From </th>
                <th class='to'> To </th>
                <th class='status'> Status </th>
                <th class='value'> Value </th>
            </tr>
        </thead>
        <tbody>

        </tbody>
    </table>
    <style>
        #tableContainer{width:100%;}
    .value{
        width:300px;
    }
    #tbTransactionHeader{
        position:fixed;
        height:50px;
    }
    #tbTransactionHeader thead{
        color: #fff;
        background: #000;
    }
    #tbTransactionHeader thead th{
        line-height: 30px;
        text-align: center;
        vertical-align: middle;
        padding:5px 5px 5px 5px;
    }

    #tbTransactionList{
       table-layout: auto;
       width:100%;
    }
    #tbTransactionList thead{
        color: #fff;
        background: #000;
    }
    #tbTransactionList thead th{
        line-height: 40px;
        text-align: center;
        vertical-align: middle;
    }

    #tbTransactionList tbody{
        display:block;
        overflow:auto;
        height:650px;
        width:100%;
    }
    #tbTransactionList thead tr{
        display:block;
    }
    #tbTransactionList tbody td:last-child{
        background-color:silver !important;
        width:300px;
    }
    #tbTransactionList tbody td{
        padding:5px 5px 5px 5px;
        height:30px;
        text-align: center;
        vertical-align: middle;
    }

    #tbTransactionList tbody tr:hover td{
        background-color:#9ea7ce;
        cursor: pointer;
    }
    #tbTransactionList tbody tr:nth-child(even){
        background-color:#4e515d;
        color:#fff;
    }
    #tbTransactionList tbody tr:nth-child(odd){
        background-color:#cadcdb73;
        
        color:#000;
    }
    
    </style>
<script>
    var tableOffset = $("#tbTransactionList").offset().top;
var $header = $("#tbTransactionList > thead").clone();
var $fixedHeader = $("#tbTransactionList").append($header);

$(window).bind("scroll", function() {
    var offset = $(this).scrollTop();

    if (offset >= tableOffset && $fixedHeader.is(":hidden")) {
        $fixedHeader.show();
    }
    else if (offset < tableOffset) {
        $fixedHeader.hide();
    }
});
</script>
{% endblock %}

{% block js %}
<script>
  function setCookie(cname, cvalue, exdays) {
      var d = new Date();
      d.setTime(d.getTime() + (exdays*24*60*60*1000));
      var expires = "expires="+ d.toUTCString();
      document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
  }
  function getCookie(cname) {
      var name = cname + "=";
      var decodedCookie = decodeURIComponent(document.cookie);
      var ca = decodedCookie.split(';');
      for(var i = 0; i <ca.length; i++) {
          var c = ca[i];
          while (c.charAt(0) == ' ') {
              c = c.substring(1);
          }
          if (c.indexOf(name) == 0) {
              return c.substring(name.length, c.length);
          }
      }
      return "";
  }
  function checkCookie() {
      var cpk = getCookie("cpk");
      var cadr = getCookie("cadr");
      if ( cadr != "" && cpk !="" ) {
          return true;
      } else {
          return false;
      }
  }

if(!checkCookie()){
    document.location="./";
}
</script>
<script>

particlesJS('particles-js',

{
"particles": {
"number": {
  "value": 80,
  "density": {
    "enable": true,
    "value_area": 800
  }
},
"color": {
  "value": "#ffffff"
},
"shape": {
  "type": "circle",
  "stroke": {
    "width": 0,
    "color": "#000000"
  },
  "polygon": {
    "nb_sides": 5
  },
  "image": {
    "src": "img/github.svg",
    "width": 100,
    "height": 100
  }
},
"opacity": {
  "value": 0.5,
  "random": false,
  "anim": {
    "enable": false,
    "speed": 1,
    "opacity_min": 0.1,
    "sync": false
  }
},
"size": {
  "value": 5,
  "random": true,
  "anim": {
    "enable": false,
    "speed": 40,
    "size_min": 0.1,
    "sync": false
  }
},
"line_linked": {
  "enable": true,
  "distance": 150,
  "color": "#ffffff",
  "opacity": 0.4,
  "width": 1
},
"move": {
  "enable": true,
  "speed": 6,
  "direction": "none",
  "random": false,
  "straight": false,
  "out_mode": "out",
  "attract": {
    "enable": false,
    "rotateX": 600,
    "rotateY": 1200
  }
}
},
"interactivity": {
"detect_on": "canvas",
"events": {
  "onhover": {
    "enable": true,
    "mode": "repulse"
  },
  "onclick": {
    "enable": true,
    "mode": "push"
  },
  "resize": true
},
"modes": {
  "grab": {
    "distance": 400,
    "line_linked": {
      "opacity": 1
    }
  },
  "bubble": {
    "distance": 400,
    "size": 40,
    "duration": 2,
    "opacity": 8,
    "speed": 3
  },
  "repulse": {
    "distance": 200
  },
  "push": {
    "particles_nb": 4
  },
  "remove": {
    "particles_nb": 2
  }
}
},
"retina_detect": true,
"config_demo": {
"hide_card": false,
"background_color": "#b61924",
"background_image": "",
"background_position": "50% 50%",
"background_repeat": "no-repeat",
"background_size": "cover"
}
}

);
var count_particles, stats, update;
$(document).ready(function(){
$("#particles-js").hide();
});
</script>


<script>

if (typeof web3 !== 'undefined') {
  web3 = new Web3(web3.currentProvider);
} else {
  web3 = new Web3(new Web3.providers.HttpProvider("https://rinkeby.infura.io/"));
}

var pK = getCookie('cpk');
Addr = keythereum.privateKeyToAddress(pK);
web3.eth.defaultAccount = Addr;

var pK = getCookie('cpk');
Addr = keythereum.privateKeyToAddress(pK);
web3.eth.defaultAccount = Addr;

$(document).ready(function(){
  $("#particles-js").show();
  var addr =getCookie('cadr');
  var pk = getCookie('cpk');
  SendFundsByDirect();
  function SendFundsByDirect(){
    url = API + "getTransactionList";
    data = {
      wallet_Address:addr,
      
    }
    $.post(url,data,function(response){
      console.log(response.data)
      $.each( response.data, function( key, value ) {
            tmpHtml = "<tr>";
                tmpHtml += "<td class='hash'>"+value.hash+"</td>";
                tmpHtml += "<td class='direction'><font color='"+(value.direction=="out"?"#842424":"green")+"' >"+value.direction+"</font></td>";
                tmpHtml += "<td class='from'>"+value.from+"</td>";
                tmpHtml += "<td class='to'>"+value.to+"</td>";
                tmpHtml += "<td class='status'><font color='"+(value.status!=true?"#842424":"green")+"' >"+value.status+"</font></td>";
                tmpHtml += "<td class='value'>"+value.value+"</td>";
            tmpHtml += "</tr>";
            $("#tbTransactionList tbody").append(tmpHtml);
        });
        $("#tbTransactionList thead .hash").width($("#tbTransactionList tbody .hash").width());
        $("#tbTransactionList thead .direction").width($("#tbTransactionList tbody .direction").width());
        $("#tbTransactionList thead .from").width($("#tbTransactionList tbody .from").width());
        $("#tbTransactionList thead .to").width($("#tbTransactionList tbody .to").width());
        $("#tbTransactionList thead .status").width($("#tbTransactionList tbody .status").width());
        $("#tbTransactionList thead .value").width($("#tbTransactionList tbody .value").width());

        width = $("#tbTransactionList .value").width() + $("#tbTransactionList .status").width()
        +$("#tbTransactionList .to").width() + $("#tbTransactionList .from").width()
        +$("#tbTransactionList .direction").width() +$("#tbTransactionList .hash").width();
        $("#tableContainer").width(width+"px");
        
      $("#particles-js").hide();
    },'json');
  }

});
 
</script>
{% endblock %}